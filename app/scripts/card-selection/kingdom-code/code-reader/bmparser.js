"use strict";function BitMatrixParser(r){const t=r.Dimension;if(t<21||1!=(3&t))throw"Error BitMatrixParser";this.bitMatrix=r,this.parsedVersion=null,this.parsedFormatInfo=null,this.copyBit=function(r,t,o){return this.bitMatrix.get_Renamed(r,t)?o<<1|1:o<<1},this.readFormatInformation=function(){if(null!=this.parsedFormatInfo)return this.parsedFormatInfo;let r=0;for(var t=0;t<6;t++)r=this.copyBit(t,8,r);r=this.copyBit(7,8,r),r=this.copyBit(8,8,r),r=this.copyBit(8,7,r);for(var o=5;o>=0;o--)r=this.copyBit(8,o,r);if(this.parsedFormatInfo=FormatInformation.decodeFormatInformation(r),null!=this.parsedFormatInfo)return this.parsedFormatInfo;const i=this.bitMatrix.Dimension;r=0;const s=i-8;for(t=i-1;t>=s;t--)r=this.copyBit(t,8,r);for(o=i-7;o<i;o++)r=this.copyBit(8,o,r);if(this.parsedFormatInfo=FormatInformation.decodeFormatInformation(r),null!=this.parsedFormatInfo)return this.parsedFormatInfo;throw"Error readFormatInformation"},this.readVersion=function(){if(null!=this.parsedVersion)return this.parsedVersion;const r=this.bitMatrix.Dimension,t=r-17>>2;if(t<=6)return Version.getVersionForNumber(t);let o=0;const i=r-11;for(var s=5;s>=0;s--)for(var n=r-9;n>=i;n--)o=this.copyBit(n,s,o);if(this.parsedVersion=Version.decodeVersionInformation(o),null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==r)return this.parsedVersion;o=0;for(n=5;n>=0;n--)for(s=r-9;s>=i;s--)o=this.copyBit(n,s,o);if(this.parsedVersion=Version.decodeVersionInformation(o),null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==r)return this.parsedVersion;throw"Error readVersion"},this.readCodewords=function(){const r=this.readFormatInformation(),t=this.readVersion(),o=DataMask.forReference(r.DataMask),i=this.bitMatrix.Dimension;o.unmaskBitMatrix(this.bitMatrix,i);const s=t.buildFunctionPattern();let n=!0;const e=new Array(t.TotalCodewords);let a=0,d=0,h=0;for(let r=i-1;r>0;r-=2){6==r&&r--;for(let t=0;t<i;t++){const o=n?i-1-t:t;for(let t=0;t<2;t++)s.get_Renamed(r-t,o)||(h++,d<<=1,this.bitMatrix.get_Renamed(r-t,o)&&(d|=1),8==h&&(e[a++]=d,h=0,d=0))}n^=!0}if(a!=t.TotalCodewords)throw"Error readCodewords";return e}}