"use strict";const qrcode={};function URShift(e,o){return e>=0?e>>o:(e>>o)+(2<<~o)}qrcode.imagedata=null,qrcode.width=0,qrcode.height=0,qrcode.qrCodeSymbol=null,qrcode.debug=!1,qrcode.maxImgSize=1048576,qrcode.sizeOfDataLengthInfo=[[10,9,8,8],[12,11,16,10],[14,13,16,12]],qrcode.callback=null,qrcode.vidSuccess=function(e){qrcode.localstream=e,qrcode.webkit?qrcode.video.src=window.webkitURL.createObjectURL(e):qrcode.moz?(qrcode.video.mozSrcObject=e,qrcode.video.play()):qrcode.video.src=e,qrcode.gUM=!0,qrcode.canvas_qr2=document.createElement("canvas"),qrcode.canvas_qr2.id="qr-canvas",qrcode.qrcontext2=qrcode.canvas_qr2.getContext("2d"),qrcode.canvas_qr2.width=qrcode.video.videoWidth,qrcode.canvas_qr2.height=qrcode.video.videoHeight,setTimeout(qrcode.captureToCanvas,500)},qrcode.vidError=function(e){qrcode.gUM=!1},qrcode.captureToCanvas=function(){if(qrcode.gUM)try{if(0==qrcode.video.videoWidth)return void setTimeout(qrcode.captureToCanvas,500);qrcode.canvas_qr2.width=qrcode.video.videoWidth,qrcode.canvas_qr2.height=qrcode.video.videoHeight,qrcode.qrcontext2.drawImage(qrcode.video,0,0);try{qrcode.decode()}catch(e){console.log(e),setTimeout(qrcode.captureToCanvas,500)}}catch(e){console.log(e),setTimeout(qrcode.captureToCanvas,500)}},qrcode.setWebcam=function(e){const o=navigator;qrcode.video=document.getElementById(e);let r=!0;if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)try{navigator.mediaDevices.enumerateDevices().then(e=>{e.forEach(e=>{console.log("deb1"),"videoinput"===e.kind&&e.label.toLowerCase().search("back")>-1&&(r=[{sourceId:e.deviceId}]),console.log(`${e.kind}: ${e.label} id = ${e.deviceId}`)})})}catch(e){console.log(e)}else console.log("no navigator.mediaDevices.enumerateDevices");o.getUserMedia?o.getUserMedia({video:r,audio:!1},qrcode.vidSuccess,qrcode.vidError):o.webkitGetUserMedia?(qrcode.webkit=!0,o.webkitGetUserMedia({video:r,audio:!1},qrcode.vidSuccess,qrcode.vidError)):o.mozGetUserMedia&&(qrcode.moz=!0,o.mozGetUserMedia({video:r,audio:!1},qrcode.vidSuccess,qrcode.vidError))},qrcode.decode=function(e){if(0==arguments.length){if(qrcode.canvas_qr2)var o=qrcode.canvas_qr2,r=qrcode.qrcontext2;else r=(o=document.getElementById("qr-canvas")).getContext("2d");return qrcode.width=o.width,qrcode.height=o.height,qrcode.imagedata=r.getImageData(0,0,qrcode.width,qrcode.height),qrcode.result=qrcode.process(r),null!=qrcode.callback&&qrcode.callback(qrcode.result),qrcode.result}{const o=new Image;o.crossOrigin="Anonymous",o.onload=function(){const e=document.getElementById("out-canvas");if(null!=e){const r=e.getContext("2d");r.clearRect(0,0,320,240),r.drawImage(o,0,0,320,240)}const r=document.createElement("canvas"),t=r.getContext("2d");let d=o.height,c=o.width;if(o.width*o.height>qrcode.maxImgSize){const e=o.width/o.height;c=e*(d=Math.sqrt(qrcode.maxImgSize/e))}r.width=c,r.height=d,t.drawImage(o,0,0,r.width,r.height),qrcode.width=r.width,qrcode.height=r.height;try{qrcode.imagedata=t.getImageData(0,0,r.width,r.height)}catch(e){return qrcode.result="Cross domain image reading not supported in your browser! Save it to your computer then drag and drop the file!",void(null!=qrcode.callback&&qrcode.callback(qrcode.result))}try{qrcode.result=qrcode.process(t)}catch(e){console.log(e),qrcode.result="error decoding QR Code"}null!=qrcode.callback&&qrcode.callback(qrcode.result)},o.onerror=function(){null!=qrcode.callback&&qrcode.callback("Failed to load the image")},o.src=e}},qrcode.isUrl=function(e){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)},qrcode.decode_url=function(e){let o="";try{o=escape(e)}catch(r){console.log(r),o=e}let r="";try{r=decodeURIComponent(o)}catch(e){console.log(e),r=o}return r},qrcode.decode_utf8=function(e){return qrcode.isUrl(e)?qrcode.decode_url(e):e},qrcode.process=function(e){const o=(new Date).getTime(),r=qrcode.grayScaleToBitmap(qrcode.grayscale());if(qrcode.debug){for(var t=0;t<qrcode.height;t++)for(var d=0;d<qrcode.width;d++){var c=4*d+t*qrcode.width*4;qrcode.imagedata.data[c]=(r[d+t*qrcode.width],0),qrcode.imagedata.data[c+1]=(r[d+t*qrcode.width],0),qrcode.imagedata.data[c+2]=r[d+t*qrcode.width]?255:0}e.putImageData(qrcode.imagedata,0,0)}const a=new Detector(r).detect();if(qrcode.debug){for(t=0;t<a.bits.Height;t++)for(d=0;d<a.bits.Width;d++){c=4*d*2+2*t*qrcode.width*4;qrcode.imagedata.data[c]=(a.bits.get_Renamed(d,t),0),qrcode.imagedata.data[c+1]=(a.bits.get_Renamed(d,t),0),qrcode.imagedata.data[c+2]=a.bits.get_Renamed(d,t)?255:0}e.putImageData(qrcode.imagedata,0,0)}const i=Decoder.decode(a.bits).DataByte;let n="";for(let e=0;e<i.length;e++)for(let o=0;o<i[e].length;o++)n+=String.fromCharCode(i[e][o]);const q=(new Date).getTime()-o;return console.log(q),qrcode.decode_utf8(n)},qrcode.getPixel=function(e,o){if(qrcode.width<e)throw"point error";if(qrcode.height<o)throw"point error";const r=4*e+o*qrcode.width*4;return(33*qrcode.imagedata.data[r]+34*qrcode.imagedata.data[r+1]+33*qrcode.imagedata.data[r+2])/100},qrcode.binarize=function(e){const o=new Array(qrcode.width*qrcode.height);for(let r=0;r<qrcode.height;r++)for(let t=0;t<qrcode.width;t++){const d=qrcode.getPixel(t,r);o[t+r*qrcode.width]=d<=e}return o},qrcode.getMiddleBrightnessPerArea=function(e){const o=Math.floor(qrcode.width/4),r=Math.floor(qrcode.height/4),t=new Array(4);for(let e=0;e<4;e++){t[e]=new Array(4);for(let o=0;o<4;o++)t[e][o]=new Array(0,0)}for(var d=0;d<4;d++)for(var c=0;c<4;c++){t[c][d][0]=255;for(let a=0;a<r;a++)for(let i=0;i<o;i++){const n=e[o*c+i+(r*d+a)*qrcode.width];n<t[c][d][0]&&(t[c][d][0]=n),n>t[c][d][1]&&(t[c][d][1]=n)}}const a=new Array(4);for(let e=0;e<4;e++)a[e]=new Array(4);for(d=0;d<4;d++)for(c=0;c<4;c++)a[c][d]=Math.floor((t[c][d][0]+t[c][d][1])/2);return a},qrcode.grayScaleToBitmap=function(e){const o=qrcode.getMiddleBrightnessPerArea(e),r=o.length,t=Math.floor(qrcode.width/r),d=Math.floor(qrcode.height/r),c=new ArrayBuffer(qrcode.width*qrcode.height),a=new Uint8Array(c);for(let c=0;c<r;c++)for(let i=0;i<r;i++)for(let r=0;r<d;r++)for(let n=0;n<t;n++)a[t*i+n+(d*c+r)*qrcode.width]=e[t*i+n+(d*c+r)*qrcode.width]<o[i][c];return a},qrcode.grayscale=function(){const e=new ArrayBuffer(qrcode.width*qrcode.height),o=new Uint8Array(e);for(let e=0;e<qrcode.height;e++)for(let r=0;r<qrcode.width;r++){const t=qrcode.getPixel(r,e);o[r+e*qrcode.width]=t}return o};